{
 'Реквизиты': {
  'Код': '000000001',
  'Наименование': 'Уведомление о завершенных задачах',
  'ТекстОбработки': 'ДатаУведомления = ТекущаяДатаСеанса();
ДатаПоследнегоУведомления = Константы.DT_ДатаУведомленияОЗавершенных.Получить();

Если (ДатаПоследнегоУведомления = \u002700010101000000\u0027) Тогда
	ДатаПоследнегоУведомления = ДатаУведомления - 24*60*60;
КонецЕсли;

Запрос = Новый Запрос(
	"ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ЗадачаИсполнителя.Ссылка КАК Ссылка,
	|	ЗадачаИсполнителя.Номер КАК Номер,
	|	ЗадачаИсполнителя.ДатаИсполнения КАК ДатаИсполнения,
	|	ЗадачаИсполнителя.Наименование КАК Наименование,
	|	ЗадачаИсполнителя.СрокИсполнения КАК СрокИсполнения,
	|	ЗадачаИсполнителя.Автор КАК Автор,
	|	ЗадачаИсполнителя.РезультатВыполнения КАК РезультатВыполнения,
	|	ЗадачаИсполнителя.Описание КАК Описание,
	|	ВЫБОР
	|		КОГДА ЗадачаИсполнителя.Исполнитель <> НЕОПРЕДЕЛЕНО
	|			ТОГДА ЗадачаИсполнителя.Исполнитель
	|		ИНАЧЕ ИсполнителиЗадач.Исполнитель
	|	КОНЕЦ КАК Исполнитель,
	|	ЗадачаИсполнителя.РольИсполнителя КАК РольИсполнителя,
	|	ЗадачаИсполнителя.ОсновнойОбъектАдресации КАК ОсновнойОбъектАдресации,
	|	ЗадачаИсполнителя.ДополнительныйОбъектАдресации КАК ДополнительныйОбъектАдресации
	|ИЗ
	|	Задача.ЗадачаИсполнителя КАК ЗадачаИсполнителя
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ИсполнителиЗадач КАК ИсполнителиЗадач
	|		ПО ЗадачаИсполнителя.РольИсполнителя = ИсполнителиЗадач.РольИсполнителя
	|			И ЗадачаИсполнителя.ОсновнойОбъектАдресации = ИсполнителиЗадач.ОсновнойОбъектАдресации
	|			И ЗадачаИсполнителя.ДополнительныйОбъектАдресации = ИсполнителиЗадач.ДополнительныйОбъектАдресации
	|ГДЕ
	|	ЗадачаИсполнителя.Выполнена = ИСТИНА
	|	И ЗадачаИсполнителя.Дата МЕЖДУ &ДатаВремяОт И &ДатаВремяПо
	|	И ЗадачаИсполнителя.ПометкаУдаления = ЛОЖЬ
	|	И (ЗадачаИсполнителя.Исполнитель <> ЗНАЧЕНИЕ(Справочник.Пользователи.ПустаяСсылка)
	|			ИЛИ ИсполнителиЗадач.Исполнитель ЕСТЬ НЕ NULL 
	|				И ИсполнителиЗадач.Исполнитель <> ЗНАЧЕНИЕ(Справочник.Пользователи.ПустаяСсылка))
	|	И ЗадачаИсполнителя.СтатусЗадачи = ЗНАЧЕНИЕ(Перечисление.СтатусЗадачи.Выполнена)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Исполнитель,
	|	СрокИсполнения УБЫВ
	|ИТОГИ ПО
	|	Автор");
Запрос.Параметры.Вставить("ДатаВремяОт", ДатаПоследнегоУведомления + 1);
Запрос.Параметры.Вставить("ДатаВремяПо", ДатаУведомления);
ЗадачиПоИсполнителям = Запрос.Выполнить().Выгрузить(ОбходРезультатаЗапроса.ПоГруппировкам);

Для Каждого СтрокаИсполнителя Из ЗадачиПоИсполнителям.Строки Цикл
	DT_ОбщегоНазначения.ОтправитьУведомлениеОЗавершенныхЗадачах(СтрокаИсполнителя.Автор, СтрокаИсполнителя);
КонецЦикла;

УстановитьПривилегированныйРежим(Истина);
Константы.DT_ДатаУведомленияОЗавершенных.Установить(ДатаУведомления);
УстановитьПривилегированныйРежим(Ложь);',
  'Комментарий': ''
 },
 'ТЧ': [
  {
   'Переменные': []
  }
 ]
}
